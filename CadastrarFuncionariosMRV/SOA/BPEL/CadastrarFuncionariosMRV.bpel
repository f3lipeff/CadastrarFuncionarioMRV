<?xml version = "1.0" encoding = "UTF-8" ?>
<!--
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  Oracle JDeveloper BPEL Designer 
  
  Created: Thu Jul 28 16:51:44 BRT 2016
  Author:  lipe
  Type: BPEL 2.0 Process
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
-->
<process name="CadastrarFuncionariosMRV"
               targetNamespace="http://xmlns.oracle.com/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/CadastrarFuncionariosMRV"
               xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
               xmlns:client="http://xmlns.oracle.com/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/CadastrarFuncionariosMRV"
               xmlns:ora="http://schemas.oracle.com/xpath/extension"
               xmlns:ui="http://xmlns.oracle.com/soa/designer"
               xmlns:bpelx="http://schemas.oracle.com/bpel/extension"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns1="urn:br:com:mrv:HCM001_Dados_Cadastro_Funcionario"
         xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
         xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
         xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
         xmlns:ess="http://xmlns.oracle.com/scheduler" xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
         xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
         xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
         xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
         xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
         xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
         xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
         xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/db/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/userReconDB"
         xmlns:ns3="http://xmlns.oracle.com/pcbpel/adapter/db/top/userReconDB"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:ns4="http://xmlns.oracle.com/pcbpel/adapter/db/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/prSoaGerarCamposUsuarioDB"
         xmlns:ns5="http://xmlns.oracle.com/pcbpel/adapter/db/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/FindLoginSuperiorDB"
         xmlns:ns6="http://xmlns.oracle.com/pcbpel/adapter/db/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/FindCNDB"
         xmlns:ns7="http://xmlns.oracle.com/pcbpel/adapter/db/FindCNDB"
         xmlns:ns8="http://xmlns.oracle.com/pcbpel/adapter/db/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/findMailBoxDB"
         xmlns:ns9="http://xmlns.oracle.com/pcbpel/adapter/db/sp/findMailBoxDB"
         xmlns:ns10="http://xmlns.oracle.com/pcbpel/adapter/db/FindLoginSuperiorDB">
  <import namespace="http://xmlns.oracle.com/pcbpel/adapter/db/top/userReconDB"
          location="../Schemas/userReconDB_table.xsd" importType="http://www.w3.org/2001/XMLSchema"/>
  <import ui:processWSDL="true" namespace="http://xmlns.oracle.com/CadastrarFuncionariosMRVApp/CadastrarFuncionariosMRV/CadastrarFuncionariosMRV" location="../WSDLs/CadastrarFuncionariosMRV.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"/>
    <!-- 
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        PARTNERLINKS                                                      
        List of services participating in this BPEL process               
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    --> 
  <partnerLinks>
    <!-- 
      The 'client' role represents the requester of this service. It is 
      used for callback. The location and correlation information associated
      with the client role are automatically set using WS-Addressing.
    -->
    <partnerLink name="cadastrarfuncionariosmrv_client" partnerLinkType="client:CadastrarFuncionariosMRV" myRole="CadastrarFuncionariosMRVProvider" partnerRole="CadastrarFuncionariosMRVRequester"/>
    <partnerLink name="MiDadosCadastroWS" partnerLinkType="ns1:MiDadosCadastroWS" partnerRole="MI_DADOS_CADASTRO_OUT"/>
    <partnerLink name="userReconDB" partnerLinkType="ns2:userReconDB_plt" partnerRole="userReconDB_role"/>
    <partnerLink name="prSoaGerarCamposUsuarioDB" partnerLinkType="ns4:prSoaGerarCamposUsuarioDB_plt"
                 partnerRole="prSoaGerarCamposUsuarioDB_role"/>
    <partnerLink name="FindLoginSuperiorDB" partnerLinkType="ns5:FindLoginSuperiorDB_plt"
                 partnerRole="FindLoginSuperiorDB_role"/>
    <partnerLink name="FindCNDB" partnerLinkType="ns6:FindCNDB_plt" partnerRole="FindCNDB_role"/>
    <partnerLink name="findMailBoxDB" partnerLinkType="ns8:findMailBoxDB_plt" partnerRole="findMailBoxDB_role"/>
  </partnerLinks>

  <!-- 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      VARIABLES                                                        
      List of messages and XML documents used within this BPEL process 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  -->
  <variables>
    <!-- Reference to the message passed as input during initiation -->
    <variable name="inputVariable" messageType="client:CadastrarFuncionariosMRVRequestMessage"/>
    <variable name="outputVariable" messageType="client:CadastrarFuncionariosMRVResponseMessage"/>
  </variables>
  <!-- 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
     ORCHESTRATION LOGIC                                               
     Set of activities coordinating the flow of messages across the    
     services integrated within this business process                  
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  -->
  <sequence name="main">

    <!-- Receive input from requestor. (Note: This maps to operation defined in CadastrarFuncionariosMRV.wsdl) -->
    <receive name="receiveInput" partnerLink="cadastrarfuncionariosmrv_client" portType="client:CadastrarFuncionariosMRV" operation="process" variable="inputVariable" createInstance="yes"/>
    <scope name="LookAndPersistData">
      <variables>
        <variable name="InvokeMIDadosCadastroWS_InputVariable" messageType="ns1:MT_Dados_Cadastro_IN"/>
        <variable name="InvokeMIDadosCadastroWS_OutputVariable" messageType="ns1:MT_Dados_Cadastro_OUT"/>
        <variable name="InvokeUserReconDBMerge_InputVariable" messageType="ns2:UserReconFelipeCollection_msg"/>
      </variables>
      <sequence>
        <scope name="InvokeMIDadosCadastroWSScope">
          <sequence>
            <assign name="AssignInputWS">
              <copy>
                <from>$inputVariable.payload/client:input</from>
                <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeMIDadosCadastroWS_InputVariable.MT_Dados_Cadastro_IN/DataUltAlteracao</to>
              </copy>
            </assign>
            <invoke name="InvokeMIDadosCadastroWS" bpelx:invokeAsDetail="no" partnerLink="MiDadosCadastroWS"
                    portType="ns1:MI_DADOS_CADASTRO_OUT" operation="MI_DADOS_CADASTRO_OUT"
                    inputVariable="InvokeMIDadosCadastroWS_InputVariable"
                    outputVariable="InvokeMIDadosCadastroWS_OutputVariable"/>
          </sequence>
        </scope>
        <if name="IfWSReturnedResults">
          <documentation>
            <![CDATA[true]]>
          </documentation>
          <condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">count($InvokeMIDadosCadastroWS_OutputVariable.MT_Dados_Cadastro_OUT/DadosCadastro) &gt; 0</condition>
          <sequence>
            <scope name="CompletaDataForExistingUser">
              <forEach parallel="no" counterName="userCounter" name="ForEachUser">
                <startCounterValue expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">1</startCounterValue>
                <finalCounterValue expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">count($InvokeMIDadosCadastroWS_OutputVariable.MT_Dados_Cadastro_OUT/DadosCadastro)</finalCounterValue>
                <scope name="ForEachUserScope">
                  <variables>
                    <variable name="InvokeUserReconDBSelect_InputVariable"
                              messageType="ns2:selectByPrimaryKey_inputParameters"/>
                    <variable name="InvokeUserReconDBSelect_OutputVariable"
                              messageType="ns2:UserReconFelipeCollection_msg"/>
                    <variable name="InvokeFindLoginSuperiorDB_InputVariable"
                                  messageType="ns5:FindLoginSuperiorDBInput_msg"/>
                    <variable name="InvokeFindLoginSuperiorDB_OutputVariable"
                                messageType="ns5:FindLoginSuperiorDBOutputCollection_msg"/>
                    <variable name="InvokeFIndCNDB_InputVariable" messageType="ns6:FindCNDBInput_msg"/>
                        <variable name="InvokeFIndCNDB_OutputVariable" messageType="ns6:FindCNDBOutputCollection_msg"/>
                    <variable name="InvokeFindMailBoxDB_InputVariable" messageType="ns8:args_in_msg"/>
                    <variable name="InvokeFindMailBoxDB_OutputVariable" messageType="ns8:args_out_msg"/>
                  </variables>
                  <sequence name="Sequence1">
                    <assign name="AssignWSOutputToMergetInput">
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/PrimeiroNome'))</from>
                      <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:primeiroNome</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/NomeImediato'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:nomeImediato</to>
                      </copy>
                       <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/CentroAlocado'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:centroAlocado</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Cidade'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:cidade</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Endereco'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:endereco</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Estado'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:estado</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/CEP'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:cep</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Pais'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:pais</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/ChaveOrganizacional'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:chaveOrganizacional</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DescricaoChavOrg'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:descricaoChavorg</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/PerfilChavOrg'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:pefilChavorg</to>
                      </copy>
                      <copy>
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Idioma'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:idioma</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/TipoComunicacao'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:tipoComunicacao</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/TipoUsuarioHcm'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:tipoUsuariohcm</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/TipousuarioEcc'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:tipoUsuarioecc</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/GrupoEcc'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:grupoEcc</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DispositivoSaida'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:dispositivoSaida</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/SaidaImediata'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:saidaImediata</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Parametro1Hcm'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:parametro1Hcm</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/CodigoParametroHcm1'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:codigoParametrohcm1</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Parametro2Hcm'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:parametro2Hcm</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/CodigoParametroHcm2'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:codigoParametrohcm2</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/FuncaoEcc'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:funcaoEcc</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/FuncaoHcm1'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:funcaoHcm1</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/FuncaoHcm2'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:funcaoHcm2</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Licenca'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:licenca</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/TipoSubtype0001'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:tipoSubtype0001</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/LoginUsuario'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:loginUsuario</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/LoginAd'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:loginAd</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Exchange'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:exchange</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/CargoFuncionario'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:cargoFuncionario</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/StatusUsuario'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:statusUsuario</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DataAdmissao'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:dataAdmissao</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DataDemissao'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:dataDemissao</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Empresa'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:siglaEmpresa</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DescricaoEmpresa'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:empresa</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Departamento'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:departamento</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DecricaoUnidadeOrg'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:decricaoUo</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Sobrenome'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:sobrenome</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/NomeCompleto'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:nomeCompleto</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DescricaoCargo'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:descricaoCargo</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/MatriculaFuncionario'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:matriculaFuncionario</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/MatriculaSuperior'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:matriculaSuperior</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/OuAd'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:ouAd</to>
                      </copy>
                      <copy bpelx:insertMissingFromData="yes">
                        <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/Dominio'))</from>
                        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:dominio</to>
                      </copy>
                    </assign>
                    <scope name="InvokeUserReconScope">
                      <sequence>
                        <assign name="AssignSelectInputVar">
                          <copy bpelx:insertMissingFromData="yes">
                            <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/MatriculaFuncionario'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBSelect_InputVariable.selectByPrimaryKey_inputParameters/ns3:matriculaFuncionario</to>
                          </copy>
                        </assign>
                        <invoke name="InvokeUserReconDBSelect" bpelx:invokeAsDetail="no" partnerLink="userReconDB"
                                portType="ns2:userReconDB_ptt" operation="selectByPrimaryKey"
                                inputVariable="InvokeUserReconDBSelect_InputVariable"
                                outputVariable="InvokeUserReconDBSelect_OutputVariable"/>
                      </sequence>
                    </scope>
                    <if name="IfFoundUser">
                      <documentation>
                        <![CDATA[true]]>
                      </documentation>
                      <condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">count($InvokeUserReconDBSelect_OutputVariable.UserReconFelipeCollection/ns3:UserReconFelipe) &gt; 0</condition>
                      <sequence name="Sequence8">
                        <assign name="AssignSOAGeneratedFields">
                          <copy bpelx:insertMissingFromData="yes">
                            <from>string(bpws:getVariableData('InvokeUserReconDBSelect_OutputVariable','UserReconFelipeCollection','ns3:UserReconFelipe[1]/ns3:dataCadastro'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:dataCadastro</to>
                          </copy>
                          <copy bpelx:insertMissingFromData="yes">
                            <from>string(bpws:getVariableData('InvokeUserReconDBSelect_OutputVariable','UserReconFelipeCollection','ns3:UserReconFelipe[1]/ns3:loginAd'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:loginAd</to>
                          </copy>
                          <copy bpelx:insertMissingFromData="yes">
                            <from>string(bpws:getVariableData('InvokeUserReconDBSelect_OutputVariable','UserReconFelipeCollection','ns3:UserReconFelipe[1]/ns3:exchange'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:exchange</to>
                          </copy>
                          <copy bpelx:insertMissingFromData="yes">
                            <from>string(bpws:getVariableData('InvokeUserReconDBSelect_OutputVariable','UserReconFelipeCollection','ns3:UserReconFelipe[1]/ns3:loginUsuario'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:loginUsuario</to>
                          </copy>
                        </assign>
                      </sequence>
                      <else>
                        <scope name="InvokeFindMailBoxScope">
                          <sequence name="Sequence4">
                            <assign name="AssignInvokeFindMailBoxDB_InputVariable">
                              <copy bpelx:insertMissingFromData="yes">
                                <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/DescricaoCargo'))</from>
                                <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeFindMailBoxDB_InputVariable.InputParameters/ns9:VDESCRICAO_CARGO</to>
                              </copy>
                              <copy bpelx:insertMissingFromData="yes">
                                <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/PrimeiroNome'))</from>
                                <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeFindMailBoxDB_InputVariable.InputParameters/ns9:VPRIMEIRO_NOME</to>
                              </copy>
                            </assign>
                            <invoke name="InvokeFindMailBoxDB" bpelx:invokeAsDetail="no" partnerLink="findMailBoxDB"
                                    portType="ns8:findMailBoxDB_ptt" operation="findMailBoxDB"
                                    inputVariable="InvokeFindMailBoxDB_InputVariable"
                                    outputVariable="InvokeFindMailBoxDB_OutputVariable"/>
                            <assign name="AssignDataCadastroAndMailbox">
                              <copy>
                                <from>$InvokeFindMailBoxDB_OutputVariable.OutputParameters/ns9:FN_BUSCA_MAILBOX</from>
                                <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:mailboxDatabase</to>
                              </copy>
                              <copy>
                                <from>xp20:current-dateTime()</from>
                                <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:dataCadastro</to>
                              </copy>
                            </assign>
                          </sequence>
                        </scope>
                      </else>
                    </if>
                    <scope name="FindLoginSuperiorScope">
                      <sequence name="Sequence2">
                        <assign name="AssignInvokeFindLoginSuperiorDBInput">
                          <copy>
                            <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/MatriculaSuperior'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeFindLoginSuperiorDB_InputVariable.FindLoginSuperiorDBInput_msg/ns10:MATRICULA_SUPERIOR</to>
                          </copy>
                        </assign>
                        <invoke name="InvokeFindLoginSuperiorDB" bpelx:invokeAsDetail="no"
                                partnerLink="FindLoginSuperiorDB" portType="ns5:FindLoginSuperiorDB_ptt"
                                operation="FindLoginSuperiorDB"
                                inputVariable="InvokeFindLoginSuperiorDB_InputVariable"
                                outputVariable="InvokeFindLoginSuperiorDB_OutputVariable"/>
                        <assign name="AssignLoginSuperior">
                          <copy>
                            <from>$InvokeFindLoginSuperiorDB_OutputVariable.FindLoginSuperiorDBOutputCollection/ns10:FindLoginSuperiorDBOutput/ns10:LOGIN_AD</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:loginImediato</to>
                          </copy>
                        </assign>
                      </sequence>
                    </scope>
                    <scope name="FindCNScope">
                      <sequence name="Sequence3">
                        <assign name="AssignInvokeFIndCNDBInput">
                          <copy>
                            <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/OuAd'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeFIndCNDB_InputVariable.FindCNDBInput_msg/ns7:OU_AD</to>
                          </copy>
                          <copy ignoreMissingFromData="yes">
                            <from>string(bpws:getVariableData('InvokeMIDadosCadastroWS_OutputVariable','MT_Dados_Cadastro_OUT','DadosCadastro[$userCounter]/NomeCompleto'))</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeFIndCNDB_InputVariable.FindCNDBInput_msg/ns7:NOME_COMPLETO</to>
                          </copy>
                        </assign>
                        <invoke name="InvokeFIndCNDB" bpelx:invokeAsDetail="no" partnerLink="FindCNDB"
                                portType="ns6:FindCNDB_ptt" operation="FindCNDB"
                                inputVariable="InvokeFIndCNDB_InputVariable"
                                outputVariable="InvokeFIndCNDB_OutputVariable"/>
                        <assign name="AssignCN">
                          <copy>
                            <from>$InvokeFIndCNDB_OutputVariable.FindCNDBOutputCollection/ns7:FindCNDBOutput/ns7:CN________CN_ORG</from>
                            <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$InvokeUserReconDBMerge_InputVariable.UserReconFelipeCollection/ns3:UserReconFelipe/ns3:cnAd</to>
                          </copy>
                        </assign>
                      </sequence>
                    </scope>
                  </sequence>
                </scope>
              </forEach>
            </scope>
            <scope name="MergeUserData">
              <sequence>
                <invoke name="InvokeUserReconDBMerge" bpelx:invokeAsDetail="no" partnerLink="userReconDB"
                        portType="ns2:userReconDB_ptt" operation="merge"
                        inputVariable="InvokeUserReconDBMerge_InputVariable"/>
              </sequence>
            </scope>
            <scope name="GenerateUserFieldsAndUpdate">
              <variables>
                <variable name="InvokePrSoaGerarCamposUsuariosDB_InputVariable" messageType="ns4:args_in_msg"/>
              </variables>
              <invoke name="InvokePrSoaGerarCamposUsuariosDB" bpelx:invokeAsDetail="no"
                      partnerLink="prSoaGerarCamposUsuarioDB" portType="ns4:prSoaGerarCamposUsuarioDB_ptt"
                      operation="prSoaGerarCamposUsuarioDB"
                      inputVariable="InvokePrSoaGerarCamposUsuariosDB_InputVariable"/>
            </scope>
          </sequence>
        </if>
      </sequence>
    </scope>
    <assign name="AssignOutput">
      <copy>
        <from>"Fluxo concluído"</from>
        <to expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">$outputVariable.payload/client:result</to>
      </copy>
    </assign>
    <invoke name="callbackClient" partnerLink="cadastrarfuncionariosmrv_client" portType="client:CadastrarFuncionariosMRVCallback" operation="processResponse" inputVariable="outputVariable"/>
  </sequence>
</process>